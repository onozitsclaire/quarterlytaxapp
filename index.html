<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Quarterly Tax Calculator for 2025 | For Freelancers & 1099</title>
    <meta name="description" content="The simplest, free quarterly tax calculator for freelancers, gig workers, and 1099 contractors. Updated for 2025 tax laws, including new deductions.">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #a5b4fc;
            --secondary: #14b8a6;
            --success: #22c55e;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #0f172a;
            --gray: #64748b;
            --light-gray: #e2e8f0;
            --white: #ffffff;
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-shadow: 0 4px 6px rgba(0, 0, 0, 0.07);
            --hover-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            color: var(--dark);
            line-height: 1.6;
        }

        /* Mode Toggle */
        .mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 50px;
            padding: 4px;
            box-shadow: var(--card-shadow);
            display: flex;
            z-index: 100;
        }

        .mode-btn {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: var(--gray);
            cursor: pointer;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .mode-btn.active {
            background: var(--primary);
            color: white;
        }

        /* Header */
        .header {
            background: var(--bg-gradient);
            color: white;
            padding: 60px 20px 40px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 10px;
        }

        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .new-badge {
            display: inline-block;
            background: var(--warning);
            color: white;
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-top: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: -30px auto 40px;
            padding: 0 20px;
            position: relative;
        }

        /* Welcome Cards */
        .welcome-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            margin: 0 auto 30px;
            box-shadow: var(--card-shadow);
            display: none;
            max-width: 1200px;
            text-align: center;
        }

        .simple-mode .welcome-card.simple-welcome {
            display: block;
        }

        .pro-mode .welcome-card.pro-welcome {
            display: block;
        }

        .welcome-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 15px;
        }

        .welcome-text {
            color: var(--gray);
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 20px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .progress-bar {
            background: var(--light-gray);
            height: 8px;
            border-radius: 50px;
            overflow: hidden;
            margin: 0 auto 10px;
            max-width: 500px;
        }

        .progress-fill {
            background: var(--primary);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            border-radius: 50px;
        }

        .progress-text {
            font-size: 0.9rem;
            color: var(--gray);
        }

        .pro-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-top: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            max-width: 1200px;
            margin: 0 auto;
            width: 100%;
        }

        .input-section {
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .results-section {
            width: 100%;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
            border: 2px solid var(--light-gray);
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--hover-shadow);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-gray);
        }

        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            font-size: 1.5rem;
        }

        /* New Tag for OBBB Features */
        .new-tag {
            background: linear-gradient(135deg, var(--warning), #f97316);
            color: white;
            padding: 2px 8px;
            border-radius: 50px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 8px;
        }

        /* Input Groups */
        .input-group {
            margin-bottom: 25px;
            position: relative;
            width: 100%;
        }

        .input-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--dark);
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .help-icon {
            width: 18px;
            height: 18px;
            background: var(--primary-light);
            color: var(--primary-dark);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            cursor: help;
            font-weight: bold;
        }

        .tooltip {
            position: absolute;
            background: var(--dark);
            color: white;
            padding: 10px 12px;
            border-radius: 8px;
            font-size: 0.85rem;
            line-height: 1.4;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            max-width: 250px;
            top: -10px;
            left: 50%;
            transform: translateX(-50%) translateY(-100%);
        }

        .tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--dark);
        }

        .help-icon:hover + .tooltip {
            opacity: 1;
        }

        .input-wrapper {
            position: relative;
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            padding-left: 36px;
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: white;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        .input-prefix {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            font-weight: 600;
            pointer-events: none;
        }

        .input-suffix {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
            font-size: 0.9rem;
            pointer-events: none;
        }

        .input-example {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 6px;
            font-style: italic;
        }

        /* Simple Mode Specific */
        .simple-mode .input-example {
            display: block;
        }

        .pro-mode .input-example {
            display: none;
        }

        .simple-mode .advanced-section {
            display: none;
        }

        /* Radio Groups */
        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .radio-card {
            flex: 1;
            min-width: 120px;
            position: relative;
        }

        .radio-card input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .radio-label {
            display: block;
            padding: 12px 16px;
            border: 2px solid var(--light-gray);
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .radio-label:hover {
            border-color: var(--primary-light);
            background: rgba(99, 102, 241, 0.05);
        }

        .radio-card input[type="radio"]:checked + .radio-label {
            border-color: var(--primary);
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary-dark);
            font-weight: 600;
        }

        .radio-label .label-title {
            display: block;
            font-size: 0.95rem;
            margin-bottom: 4px;
        }

        .radio-label .label-desc {
            display: block;
            font-size: 0.75rem;
            color: var(--gray);
            font-weight: normal;
        }

        /* OBBB Deductions Section */
        .obbb-section {
            background: linear-gradient(135deg, #fef3c7 0%, #fed7aa 100%);
            border-radius: 16px;
            padding: 30px;
            margin-top: 25px;
            border: 2px solid var(--warning);
        }

        .obbb-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #92400e;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Calculate Button */
        .calculate-btn {
            width: 100%;
            padding: 16px;
            background: var(--bg-gradient);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            margin-top: 10px;
        }

        .calculate-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .calculate-btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        /* Results Section */
        .results-section {
            display: none;
            animation: fadeIn 0.5s ease;
            width: 100%;
            flex-direction: column;
            gap: 20px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-section.show {
            display: flex;
        }

        .result-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            border: 2px solid var(--light-gray);
            width: 100%;
            max-width: 100%;
            margin: 0 auto;
        }

        .result-card.highlight {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05) 0%, rgba(168, 85, 247, 0.05) 100%);
        }

        .result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-gray);
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--light-gray);
        }

        .result-row:last-child {
            border-bottom: none;
        }

        .result-label {
            color: var(--gray);
            font-size: 0.95rem;
        }

        .result-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--dark);
        }

        .result-value.primary {
            color: var(--primary);
            font-size: 1.3rem;
        }

        .result-value.success {
            color: var(--success);
        }

        .result-value.warning {
            color: var(--warning);
        }

        /* Quarterly Payments Grid */
        .quarters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .quarter-card {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            color: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quarter-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
        }

        .quarter-card:hover {
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }

        .quarter-number {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .quarter-date {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .quarter-amount {
            font-size: 1.8rem;
            font-weight: 800;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .quarter-status {
            display: inline-block;
            background: rgba(255, 255, 255, 0.3);
            padding: 4px 12px;
            border-radius: 50px;
            font-size: 0.75rem;
            margin-top: 10px;
            font-weight: 600;
        }

        /* Info Boxes - Updated to match card styling */
        .info-box {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            width: 100%;
            max-width: 100%;
            margin: 0 auto 20px;
            border: 2px solid var(--light-gray);
        }

        .info-box.warning {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border-color: var(--warning);
        }

        .info-box.success {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-color: var(--success);
        }

        .info-box.simple-mode-only {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-color: var(--secondary);
        }

        .info-title {
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.1rem;
        }

        .info-text {
            color: var(--gray);
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .info-box.simple-mode-only .info-text {
            text-align: center;
        }
        
        .info-box.simple-mode-only .info-title {
            justify-content: center;
        }
        
        .info-box.warning.simple-mode-only .info-title {
            justify-content: center;
        }
        
        .info-box.warning.simple-mode-only .info-text {
            text-align: center;
        }

        /* New Content Block Styles */
        .content-block {
            text-align: left;
            padding: 30px 40px;
        }
        .content-block .welcome-title {
            text-align: center;
        }
        .content-block h4 {
            font-weight: 700;
            color: var(--dark);
            margin-top: 25px;
            margin-bottom: 8px;
            font-size: 1.1rem;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 5px;
        }
        .content-block ul {
            list-style-position: outside;
            padding-left: 20px;
            margin-top: 15px;
            margin-bottom: 15px;
        }
        .content-block ul li {
            margin-bottom: 10px;
            padding-left: 5px;
        }
        
        /* New Tool Grid Styles */
        .tool-card {
            display: block;
            background: #f8fafc;
            border: 1px solid var(--light-gray);
            border-radius: 12px;
            padding: 25px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s ease;
        }
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--hover-shadow);
            border-color: var(--primary);
        }
        .tool-icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }
        .tool-title {
            font-weight: 700;
            margin-bottom: 8px;
        }
        .tool-description {
            font-size: 0.9rem;
            color: var(--gray);
        }
        
        /* Carousel Styles */
        .carousel-container {
            position: relative;
            width: 100%;
            margin: 0 auto;
        }
        .carousel-wrapper {
            display: flex;
            overflow-x: auto;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none;  /* Internet Explorer 10+ */
            padding-bottom: 15px; /* space for scrollbar if visible */
        }
        .carousel-wrapper::-webkit-scrollbar { 
            display: none;  /* Safari and Chrome */
        }
        .carousel-wrapper .tool-card {
            flex: 0 0 90%; 
            max-width: 90%;
            margin: 0 10px;
        }
        .tool-card.disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: #f1f5f9;
        }
         .tool-card.disabled:hover {
            transform: none;
            box-shadow: none;
            border-color: var(--light-gray);
        }
        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--light-gray);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            font-size: 28px;
            line-height: 44px;
            color: var(--dark);
            cursor: pointer;
            z-index: 10;
            display: none; 
            box-shadow: var(--card-shadow);
        }
        .carousel-btn:hover {
            background-color: white;
            box-shadow: var(--hover-shadow);
        }
        .carousel-btn.prev {
            left: -22px;
        }
        .carousel-btn.next {
            right: -22px;
        }

        @media (min-width: 640px) {
            .carousel-wrapper .tool-card {
                flex-basis: calc(50% - 20px);
                max-width: calc(50% - 20px);
            }
        }
        @media (min-width: 968px) {
            .carousel-wrapper .tool-card {
                flex-basis: calc(33.333% - 20px);
                max-width: calc(33.333% - 20px);
            }
            .carousel-btn {
                display: block; 
            }
        }

        /* Tips Carousel - Enhanced Visual Design */
        .tips-carousel {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid var(--primary-light);
            border-radius: 20px;
            padding: 30px;
            margin: 40px auto 0;
            max-width: 1200px;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.1);
            position: relative;
            overflow: hidden;
        }

        .tips-carousel::before {
            content: '💡';
            position: absolute;
            font-size: 120px;
            opacity: 0.05;
            right: -20px;
            top: -20px;
            transform: rotate(15deg);
        }

        .tips-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-dark);
            margin-bottom: 20px;
        }

        .tip-content {
            color: var(--dark);
            font-size: 1rem;
            line-height: 1.8;
            min-height: 80px;
            text-align: center;
            padding: 0 40px;
            position: relative;
            z-index: 1;
        }

        .tip-content strong {
            color: var(--primary);
            font-weight: 700;
        }

        .tip-navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }

        .tip-btn {
            padding: 10px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .tip-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .tip-dots {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 15px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--light-gray);
            transition: all 0.3s ease;
        }

        .dot.active {
            width: 24px;
            border-radius: 4px;
            background: var(--primary);
        }

        /* Educational Overlay */
        .edu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .edu-modal {
            background: white;
            border-radius: 16px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .edu-header {
            padding: 25px;
            border-bottom: 1px solid var(--light-gray);
        }

        .edu-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: 10px;
        }

        .edu-content {
            padding: 25px;
            line-height: 1.6;
        }

        .edu-content h3 {
            color: var(--dark);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .edu-content p {
            color: var(--gray);
            margin-bottom: 15px;
        }

        .edu-close {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background: var(--light-gray);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .edu-close:hover {
            background: var(--danger);
            color: white;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 40px 20px;
            color: var(--gray);
            font-size: 0.9rem;
        }

        .footer a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        /* Mobile Responsive */
        @media (max-width: 640px) {
            .mode-toggle {
                top: 10px;
                right: 10px;
                transform: scale(0.9);
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .header .subtitle {
                font-size: 1rem;
            }

            .container {
                padding: 0 15px;
            }

            .card, .result-card, .info-box, .content-block {
                padding: 20px;
            }

            .quarters-grid {
                grid-template-columns: 1fr;
            }

            .radio-group {
                flex-direction: column;
            }

            .radio-card {
                width: 100%;
            }

            .tip-content {
                padding: 0 20px;
                font-size: 0.95rem;
            }

            .pro-stats {
                flex-direction: column;
                gap: 20px;
            }

            .tips-carousel {
                padding: 20px;
            }

            .tips-carousel::before {
                font-size: 80px;
            }

            .obbb-section {
                padding: 20px;
            }

            .info-box.simple-mode-only {
                margin-top: 0;
            }
        }
    </style>
</head>
<body>
    <div class="mode-toggle">
        <button class="mode-btn active" onclick="setMode('simple')">Simple</button>
        <button class="mode-btn" onclick="setMode('pro')">Pro</button>
    </div>

    <header class="header">
        <h1>🎯 TaxBuddy</h1>
        <p class="subtitle">Your Friendly Quarterly Tax Calculator</p>
        <span class="new-badge">🎉 Updated with 2025 One Big Beautiful Bill Tax Savings!</span>
    </header>

    <div class="container">
        <div class="welcome-card simple-welcome">
            <h2 class="welcome-title">👋 Welcome! Let's Make Taxes Easy</h2>
            <p class="welcome-text">
                Don't worry if taxes feel confusing - we'll walk through this together! Just fill in what you know, and we'll calculate everything for you. Hover over any <span class="help-icon">?</span> for help.
            </p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <p class="progress-text">Progress: <span id="progressText">0%</span> complete</p>
        </div>

        <div class="welcome-card pro-welcome">
            <h2 class="welcome-title">📊 Professional Tax Calculator</h2>
            <p class="welcome-text">
                Advanced quarterly tax calculator with 2025 OBBB deductions, safe harbor calculations, and comprehensive tax planning features. All fields are optional - calculate with precision.
            </p>
            <div class="pro-stats">
                <div class="stat-item">
                    <div class="stat-value">15.3%</div>
                    <div class="stat-label">SE Tax Rate</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">$176,100</div>
                    <div class="stat-label">SS Wage Base</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">20%</div>
                    <div class="stat-label">QBI Deduction</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">$2,200</div>
                    <div class="stat-label">Child Tax Credit</div>
                </div>
            </div>
        </div>

        <div class="main-layout">
            <div class="input-section">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <span class="card-icon">💼</span>
                            Your Info
                        </h2>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            How much money will you make this year?
                            <span class="help-icon">?</span>
                            <span class="tooltip">This is your total income from freelancing, gig work, or 1099 contracts before any expenses. Include all money clients will pay you.</span>
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">$</span>
                            <input type="number" id="grossIncome" class="input-field" placeholder="0" min="0" oninput="updateProgress()">
                            <span class="input-suffix simple-mode-only">/year</span>
                        </div>
                        <p class="input-example">Example: If you charge $50/hour and work 1000 hours, enter $50,000</p>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            What will you spend on business stuff?
                            <span class="help-icon">?</span>
                            <span class="tooltip">Include computer, software, internet, phone, travel, supplies, home office, and any other business costs. Keep receipts!</span>
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">$</span>
                            <input type="number" id="businessExpenses" class="input-field" placeholder="0" min="0" oninput="updateProgress()">
                            <span class="input-suffix simple-mode-only">/year</span>
                        </div>
                        <p class="input-example">Example: $200/month for software + $100/month internet = $3,600/year</p>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            Do you also have a regular job? (W-2 income)
                            <span class="help-icon">?</span>
                            <span class="tooltip">If you work for an employer who gives you a W-2, enter that salary here. Leave at 0 if you're only freelancing.</span>
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">$</span>
                            <input type="number" id="w2Income" class="input-field" placeholder="0" min="0" oninput="updateProgress()">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            Tax already taken from paychecks
                            <span class="help-icon">?</span>
                            <span class="tooltip">Check your pay stubs for "Federal Tax Withheld" and add them up for the year. Skip if no regular job.</span>
                        </label>
                        <div class="input-wrapper">
                            <span class="input-prefix">$</span>
                            <input type="number" id="w2Withheld" class="input-field" placeholder="0" min="0" oninput="updateProgress()">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">
                            How will you file your taxes?
                            <span class="help-icon">?</span>
                            <span class="tooltip">Single = not married. Married = filing taxes together with spouse. Head of Household = single with dependents.</span>
                        </label>
                        <div class="radio-group">
                            <div class="radio-card">
                                <input type="radio" id="single" name="filingStatus" value="single" checked onchange="toggleSpouseAge()">
                                <label for="single" class="radio-label"><span class="label-title">Single</span></label>
                            </div>
                            <div class="radio-card">
                                <input type="radio" id="married" name="filingStatus" value="married" onchange="toggleSpouseAge()">
                                <label for="married" class="radio-label"><span class="label-title">Married</span></label>
                            </div>
                            <div class="radio-card">
                                <input type="radio" id="head" name="filingStatus" value="head" onchange="toggleSpouseAge()">
                                <label for="head" class="radio-label"><span class="label-title">Head of House</span></label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="input-group">
                        <label class="input-label">Number of qualifying children (under 17)?
                            <span class="help-icon">?</span>
                            <span class="tooltip">Enter the number of your dependents who will be under age 17 at the end of 2025. This is for the Child Tax Credit.</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="number" id="numChildren" class="input-field" style="padding-left: 16px;" placeholder="0" min="0" oninput="updateProgress()">
                        </div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Are you age 65 or older?
                            <span class="help-icon">?</span>
                            <span class="tooltip">Check the box(es) if you or your spouse (if filing jointly) will be age 65 or older by the end of 2025. This is for the new Bonus Deduction.</span>
                        </label>
                        <div class="radio-group" style="gap: 25px;">
                            <label><input type="checkbox" id="isOver65"> I am 65 or older</label>
                            <label id="spouseAgeLabel" style="display: none;"><input type="checkbox" id="spouseIsOver65"> My spouse is 65 or older</label>
                        </div>
                    </div>

                    <div class="obbb-section">
                        <h3 class="obbb-title">
                            🎁 New 2025 Deductions
                        </h3>
                        
                        <div class="input-group">
                            <label class="input-label">
                                Tips Income <span class="new-tag">Up to $25k deductible!</span>
                                <span class="help-icon">?</span>
                                <span class="tooltip">If you receive tips, up to $25,000 can be deducted from your income! This applies to common tipped jobs like delivery, rideshare, etc.</span>
                            </label>
                            <div class="input-wrapper">
                                <span class="input-prefix">$</span>
                                <input type="number" id="tipsIncome" class="input-field" placeholder="0" min="0" max="25000">
                            </div>
                        </div>

                        <div class="input-group">
                            <label class="input-label">
                                Overtime Pay <span class="new-tag">Up to $12.5k deductible!</span>
                                <span class="help-icon">?</span>
                                <span class="tooltip">The "half" of time-and-a-half overtime pay is now deductible! Up to $12,500 for singles, $25,000 for married.</span>
                            </label>
                            <div class="input-wrapper">
                                <span class="input-prefix">$</span>
                                <input type="number" id="overtimePay" class="input-field" placeholder="0" min="0" max="25000">
                            </div>
                        </div>

                        <div class="input-group" style="margin-bottom: 0;">
                            <label class="input-label">
                                Car Loan Interest <span class="new-tag">Up to $10k deductible!</span>
                                <span class="help-icon">?</span>
                                <span class="tooltip">Interest on a loan for a new U.S.-assembled vehicle is deductible up to $10,000. Loan must be after Dec 31, 2024.</span>
                            </label>
                            <div class="input-wrapper">
                                <span class="input-prefix">$</span>
                                <input type="number" id="carLoanInterest" class="input-field" placeholder="0" min="0" max="10000">
                            </div>
                        </div>
                    </div>

                    <div class="advanced-section">
                        <div class="input-group">
                            <label class="input-label">
                                Additional Deductions (Pro Mode)
                                <span class="help-icon">?</span>
                                <span class="tooltip">Itemized deductions, retirement contributions (IRA, 401k), health insurance premiums, etc.</span>
                            </label>
                            <div class="input-wrapper">
                                <span class="input-prefix">$</span>
                                <input type="number" id="additionalDeductions" class="input-field" placeholder="0" min="0">
                            </div>
                        </div>

                        <div class="input-group">
                            <label class="input-label">
                                Prior Year Tax (for Safe Harbor)
                                <span class="help-icon">?</span>
                                <span class="tooltip">Enter last year's total tax to calculate safe harbor payments (pay 100% or 110% of last year's tax to avoid penalties).</span>
                            </label>
                            <div class="input-wrapper">
                                <span class="input-prefix">$</span>
                                <input type="number" id="priorYearTax" class="input-field" placeholder="0" min="0">
                            </div>
                        </div>
                    </div>

                    <button class="calculate-btn" onclick="calculateTaxes()">
                        <span id="calculateText">Calculate My Taxes</span>
                    </button>
                </div>

                <div class="info-box simple-mode-only" style="margin-top: 0;">
                    <div class="info-title">
                        📚 New to taxes? Learn the basics!
                    </div>
                    <div class="info-text">
                        <a href="#" onclick="showEducation('basics')" style="color: var(--primary); text-decoration: underline;">What are quarterly taxes?</a> • 
                        <a href="#" onclick="showEducation('expenses')" style="color: var(--primary); text-decoration: underline;">What counts as an expense?</a> • 
                        <a href="#" onclick="showEducation('obbb')" style="color: var(--primary); text-decoration: underline;">New 2025 tax savings</a>
                    </div>
                </div>
            </div>

            <div class="results-section" id="resultsSection">
                <div class="result-card highlight">
                    <div class="result-header">
                        <span class="card-icon">📊</span>
                        Your Tax Breakdown
                    </div>
                    
                    <div class="result-row">
                        <span class="result-label">Total Income</span>
                        <span class="result-value" id="totalIncomeDisplay">$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Deductions (Standard + Bonus + QBI, etc.)</span>
                        <span class="result-value" id="totalDeductionsDisplay">$0</span>
                    </div>
                     <div class="result-row">
                        <span class="result-label">Taxable Income</span>
                        <span class="result-value" id="taxableIncomeDisplay">$0</span>
                    </div>
                    <div class="result-row" style="padding-top: 20px;">
                        <span class="result-label">Self-Employment Tax</span>
                        <span class="result-value" id="selfEmploymentTax">$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Income Tax (before credits)</span>
                        <span class="result-value" id="incomeTax">$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Child Tax Credit</span>
                        <span class="result-value success" id="childTaxCreditDisplay">-$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Total Estimated Tax</span>
                        <span class="result-value primary" id="totalTax">$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Tax Already Withheld</span>
                        <span class="result-value success" id="taxWithheld">-$0</span>
                    </div>
                    <div class="result-row" style="border-top: 2px solid var(--primary-light); margin-top: 10px; padding-top: 15px;">
                        <span class="result-label" style="font-weight: bold; color: var(--dark);">Estimated Tax You Still Owe</span>
                        <span class="result-value primary" id="estimatedTaxDue">$0</span>
                    </div>
                </div>

                <div class="result-card">
                    <div class="result-header">
                        <span class="card-icon">📅</span>
                        Your Quarterly Payment Schedule
                    </div>
                    
                    <div class="info-box warning simple-mode-only">
                        <div class="info-title">⚠️ Important: Save these dates!</div>
                        <div class="info-text">
                            Add these dates to your calendar! Missing a payment can result in penalties. You can pay online at IRS.gov.
                        </div>
                    </div>

                    <div class="quarters-grid">
                        <div class="quarter-card">
                            <div class="quarter-number">Quarter 1</div>
                            <div class="quarter-date">April 15, 2025</div>
                            <div class="quarter-amount" id="q1Amount">$0</div>
                            <div class="quarter-status">For Jan-Mar income</div>
                        </div>
                        <div class="quarter-card">
                            <div class="quarter-number">Quarter 2</div>
                            <div class="quarter-date">June 16, 2025</div>
                            <div class="quarter-amount" id="q2Amount">$0</div>
                            <div class="quarter-status">For Apr-May income</div>
                        </div>
                        <div class="quarter-card">
                            <div class="quarter-number">Quarter 3</div>
                            <div class="quarter-date">Sept 15, 2025</div>
                            <div class="quarter-amount" id="q3Amount">$0</div>
                            <div class="quarter-status">For Jun-Aug income</div>
                        </div>
                        <div class="quarter-card">
                            <div class="quarter-number">Quarter 4</div>
                            <div class="quarter-date">Jan 15, 2026</div>
                            <div class="quarter-amount" id="q4Amount">$0</div>
                            <div class="quarter-status">For Sep-Dec income</div>
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <div class="result-header">
                        <span class="card-icon">💡</span>
                        Good to Know
                    </div>
                    
                    <div class="result-row">
                        <span class="result-label">Your Effective Tax Rate</span>
                        <span class="result-value" id="effectiveRate">0%</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Take-Home Pay (after tax)</span>
                        <span class="result-value success" id="takeHome">$0</span>
                    </div>
                    <div class="result-row">
                        <span class="result-label">Recommended Monthly Savings</span>
                        <span class="result-value warning" id="monthlySavings">$0</span>
                    </div>
                    <div class="result-row pro-mode-only">
                        <span class="result-label">Marginal Tax Bracket</span>
                        <span class="result-value" id="marginalRate">0%</span>
                    </div>
                </div>

                <div class="info-box success">
                    <div class="info-title">✅ Your Next Steps</div>
                    <div class="info-text" id="nextSteps">
                    </div>
                </div>
            </div>
        </div>

        <div class="welcome-card content-block" style="display: block; text-align: center;">
            <h2 class="welcome-title">Explore Our Other Free Tax Tools</h2>
            <p style="color: var(--gray); max-width: 600px; margin: 0 auto 30px;">Each calculator is designed to answer a specific question about the new 2025 tax laws.</p>
            
            <div class="carousel-container">
                <button class="carousel-btn prev" onclick="scrollCarousel(-1)">&#10094;</button>
                <div class="carousel-wrapper">
                    <a href="/tip-calculator.html" class="tool-card">
                        <div class="tool-icon">💰</div>
                        <h3 class="tool-title">Tip Deduction Calculator</h3>
                        <p class="tool-description">Find out exactly how much of your tip income is deductible under the new 2025 rules.</p>
                    </a>
                    <a href="/car-loan-calculator.html" class="tool-card">
                        <div class="tool-icon">🚗</div>
                        <h3 class="tool-title">Car Loan Interest Calculator</h3>
                        <p class="tool-description">See if you qualify for the new $10,000 deduction for interest on a new, U.S.-assembled vehicle.</p>
                    </a>
                     <a href="/overtime-calculator.html" class="tool-card">
                        <div class="tool-icon">⏰</div>
                        <h3 class="tool-title">Overtime Pay Calculator</h3>
                        <p class="tool-description">Calculate your tax deduction for the "half" portion of your time-and-a-half overtime pay.</p>
                    </a>
                    <a href="#" class="tool-card disabled">
                        <div class="tool-icon">👵</div>
                        <h3 class="tool-title">Senior Bonus Deduction</h3>
                        <p class="tool-description">See if you qualify for the new $6,000+ deduction for filers aged 65 and over. (Coming Soon)</p>
                    </a>
                </div>
                <button class="carousel-btn next" onclick="scrollCarousel(1)">&#10095;</button>
            </div>
        </div>

        <div class="welcome-card content-block" style="display: block;">
            <h2 class="welcome-title">What the 2025 "One Big Beautiful Bill" Means for You</h2>
            <p>You've probably heard about the big tax changes that happened in 2025. The "One Big Beautiful Bill Act" made many of the 2017 tax cuts permanent and added some major new benefits, especially for freelancers, gig workers, and older Americans.</p>
            <p>Here's the bottom line on the changes that matter most:</p>
            <ul>
                <li><strong>Lower Tax Rates Are Here to Stay:</strong> The seven tax brackets (10%, 12%, 22%, etc.) are now permanent, so you can plan on them for the future.</li>
                <li><strong>A Bigger Standard Deduction:</strong> The standard deduction got a nice boost. For 2025, it's <strong>$15,750 for Single filers</strong> and <strong>$31,500 for Married couples filing jointly</strong>.</li>
                <li><strong>New "Bonus" Deduction for Seniors:</strong> If you're 65 or older, you can now get an extra <strong>$6,000 "bonus"</strong> added to your standard deduction ($12,000 for a married couple if both are 65+), subject to income limits.</li>
                <li><strong>More Help for Parents:</strong> The Child Tax Credit was increased to <strong>$2,200 per qualifying child</strong> under age 17.</li>
                <li><strong>The QBI Deduction is Safe:</strong> The 20% Qualified Business Income (QBI) deduction—one of the best deductions for self-employed people—is now permanent.</li>
            </ul>
            <p>This calculator has been fully updated to include all of these new 2025 rules, so the numbers you see are based on the very latest information.</p>
        </div>

        <div class="welcome-card content-block" style="display: block;">
            <h2 class="welcome-title">Frequently Asked Questions (FAQ)</h2>
            
            <h4>1. What exactly <em>are</em> quarterly taxes?</h4>
            <p>Think of it this way: when you have a W-2 job, your employer withholds taxes from every paycheck. When you're self-employed, you are your own payroll department. The IRS requires you to send them those taxes throughout the year in four "estimated" payments instead of all at once in April. It's just the government's way of ensuring a steady flow of tax revenue.</p>

            <h4>2. Do I <em>really</em> have to pay them?</h4>
            <p>The simple rule of thumb is this: if you expect to owe <strong>at least $1,000 in tax</strong> for the year, then yes, you need to pay estimated quarterly taxes. This applies to most full-time freelancers and even many people with a side hustle.</p>
            
            <h4>3. How much should I set aside from each payment?</h4>
            <p>A safe bet is to set aside <strong>25-30% of every single payment</strong> you receive. Put it into a separate savings account and don't touch it. This percentage is a good estimate because it covers both your income tax and the self-employment tax (for Social Security and Medicare).</p>

            <h4>4. When are the 2025 quarterly tax deadlines?</h4>
            <p>Mark these dates in your calendar! Missing them can lead to penalties.</p>
            <ul>
                <li><strong>Q1 (Jan 1 - Mar 31):</strong> April 15, 2025</li>
                <li><strong>Q2 (Apr 1 - May 31):</strong> June 16, 2025</li>
                <li><strong>Q3 (Jun 1 - Aug 31):</strong> September 15, 2025</li>
                <li><strong>Q4 (Sep 1 - Dec 31):</strong> January 15, 2026</li>
            </ul>

            <h4>5. How do I actually pay the IRS?</h4>
            <p>It's easier than you think. The best way is to pay for free directly from your bank account using <strong>IRS Direct Pay</strong> on their website. You don't even have to create an account. You can also use a credit/debit card (for a fee) or mail a check with a Form 1040-ES voucher, but Direct Pay is the simplest option.</p>
        </div>

        <div class="tips-carousel">
            <div class="tips-header">
                <span class="card-icon">💡</span>
                Tax Tips for Freelancers
            </div>
            <div class="tip-content" id="tipContent">
            </div>
            <div class="tip-navigation">
                <button class="tip-btn" onclick="previousTip()">← Previous</button>
                <button class="tip-btn" onclick="nextTip()">Next →</button>
            </div>
            <div class="tip-dots">
            </div>
        </div>
    </div>

    <div class="edu-overlay" id="eduOverlay">
        <div class="edu-modal">
            <button class="edu-close" onclick="closeEducation()">×</button>
            <div class="edu-header">
                <h2 class="edu-title" id="eduTitle">Tax Basics</h2>
            </div>
            <div class="edu-content" id="eduContent">
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>📊 Based on 2025 IRS tax rules & One Big Beautiful Bill Act | <a href="https://www.irs.gov/businesses/small-businesses-self-employed/estimated-taxes" target="_blank">Official IRS Guide</a></p>
        <p style="margin-top: 10px;">This calculator provides estimates only. For personalized advice, consult a tax professional.</p>
    </footer>

    <script>
        // Mode Management
        let currentMode = 'simple';
        
        function setMode(mode) {
            currentMode = mode;
            document.body.className = mode + '-mode';
            
            document.querySelectorAll('.mode-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent.toLowerCase() === mode);
            });
            
            document.getElementById('calculateText').textContent = 
                mode === 'simple' ? 'Calculate My Taxes' : 'Run Pro Calculation';
            
            if (mode === 'simple') {
                document.getElementById('additionalDeductions').value = '';
                document.getElementById('priorYearTax').value = '';
            }
        }

        function toggleSpouseAge() {
            const filingStatus = document.querySelector('input[name="filingStatus"]:checked').value;
            const spouseLabel = document.getElementById('spouseAgeLabel');
            if (filingStatus === 'married') {
                spouseLabel.style.display = 'inline-block';
            } else {
                spouseLabel.style.display = 'none';
                document.getElementById('spouseIsOver65').checked = false;
            }
            updateProgress();
        }

        function updateProgress() {
            if (currentMode !== 'simple') return;
            const fields = ['grossIncome', 'businessExpenses', 'numChildren'];
            let filled = 0;
            let totalFields = fields.length + 1; // +1 for filing status
            
            fields.forEach(id => {
                if (document.getElementById(id).value) filled++;
            });
            
            if (document.querySelector('input[name="filingStatus"]:checked')) filled++;
            
            const progress = Math.round((filled / totalFields) * 100);
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = progress + '%';
        }

        const tips = [
            "<strong>Tip #1:</strong> The 2025 Child Tax Credit is $2,200 per child, but it phases out for higher incomes. Make sure you enter your number of children for an accurate calculation!",
            "<strong>Tip #2:</strong> For 2025, the 1099-K reporting threshold is over $20,000 AND more than 200 transactions. But remember, you must report ALL income, even if you don't get a form!",
            "<strong>Tip #3:</strong> Set aside 25-30% of every payment you receive for taxes. It's much easier than trying to find a large sum when the due date hits.",
            "<strong>Tip #4:</strong> Are you 65 or older? A new 'bonus deduction' for 2025 can significantly increase your standard deduction and lower your taxes.",
            "<strong>Tip #5:</strong> Home office deduction: If you use part of your home exclusively for work, you can deduct a portion of your rent/mortgage and utilities.",
            "<strong>Tip #6:</strong> Mileage adds up! Track every business trip—the 2025 rate is 70 cents per mile.",
            "<strong>Tip #7:</strong> The 20% Qualified Business Income (QBI) deduction is permanent. This is one of the most valuable deductions for freelancers.",
            "<strong>Tip #8:</strong> Keep digital copies of all receipts. Good recordkeeping is your best defense in an audit and ensures you get every deduction.",
            "<strong>Tip #9:</strong> Retirement savings reduce your taxes! Contributions to a SEP-IRA or Solo 401(k) are deductible.",
            "<strong>Tip #10:</strong> Don't forget digital assets! Income from things like cryptocurrencies is taxable and must be reported on your return."
        ];

        let currentTip = 0;

        function updateTipDisplay() {
            document.getElementById('tipContent').innerHTML = tips[currentTip];
            const dotsContainer = document.querySelector('.tip-dots');
            dotsContainer.innerHTML = '';
            tips.forEach((_, index) => {
                const dot = document.createElement('span');
                dot.className = 'dot';
                if (index === currentTip) {
                    dot.classList.add('active');
                }
                dotsContainer.appendChild(dot);
            });
        }
        
        function nextTip() {
            currentTip = (currentTip + 1) % tips.length;
            updateTipDisplay();
        }

        function previousTip() {
            currentTip = (currentTip - 1 + tips.length) % tips.length;
            updateTipDisplay();
        }

        const educationContent = {
            basics: {
                title: "What Are Quarterly Taxes?",
                content: `<h3>The Basics</h3><p>When you're self-employed, you're your own boss and your own payroll department. The IRS requires you to pay income and self-employment taxes throughout the year in four installments, known as quarterly estimated taxes.</p><h3>Why?</h3><p>The U.S. has a pay-as-you-go tax system. If you were a W-2 employee, your employer would withhold these taxes for you. As a freelancer, you're responsible for doing it yourself.</p><h3>Who Has to Pay?</h3><p>Generally, you must pay estimated taxes if you expect to owe at least $1,000 in tax for the year after subtracting any withholding.</p>`
            },
            expenses: {
                title: "What Can I Deduct?",
                content: `<h3>The Golden Rule</h3><p>If a purchase is "ordinary and necessary" for your business, it's likely deductible. This means it's a common expense in your industry and helpful for your work.</p><h3>Common Deductions</h3><p><strong>✓ Home Office:</strong> A portion of your rent/mortgage and utilities if you have a dedicated workspace.</p><p><strong>✓ Software & Subscriptions:</strong> Adobe Creative Suite, project management tools, etc.</p><p><strong>✓ Business Mileage:</strong> The portion of your car expenses used for business travel.</p><p><strong>✓ Supplies:</strong> Anything from office paper to materials needed for your craft.</p><p><strong>✓ Professional Development:</strong> Courses, workshops, and industry conferences.</p>`
            },
            obbb: {
                title: "New 2025 Tax Savings",
                content: `<h3>Bonus Deduction (65+)</h3><p>A new deduction for those 65 and older can add <strong>$6,000</strong> (single) or <strong>$12,000</strong> (married) to your standard deduction, if your income is below the phaseout levels.</p><h3>Child Tax Credit Boost</h3><p>The credit is increased to <strong>$2,200</strong> per qualifying child under 17.</p><h3>Other Big Deductions</h3><p>Don't forget the new deductions for <strong>Tip Income</strong> (up to $25k), the "half" of <strong>Overtime Pay</strong> (up to $12.5k), and <strong>Car Loan Interest</strong> (up to $10k) on new, U.S.-assembled vehicles.</p>`
            }
        };

        function showEducation(topic) {
            const content = educationContent[topic];
            document.getElementById('eduTitle').textContent = content.title;
            document.getElementById('eduContent').innerHTML = content.content;
            document.getElementById('eduOverlay').style.display = 'flex';
        }

        function closeEducation() {
            document.getElementById('eduOverlay').style.display = 'none';
        }

        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(amount);
        }

        function calculateTaxes() {
            // 1. Get All Input Values
            const grossIncome = parseFloat(document.getElementById('grossIncome').value) || 0;
            const businessExpenses = parseFloat(document.getElementById('businessExpenses').value) || 0;
            const w2Income = parseFloat(document.getElementById('w2Income').value) || 0;
            const w2Withheld = parseFloat(document.getElementById('w2Withheld').value) || 0;
            const filingStatus = document.querySelector('input[name="filingStatus"]:checked').value;
            const numChildren = parseInt(document.getElementById('numChildren').value) || 0;
            const isOver65 = document.getElementById('isOver65').checked;
            const spouseIsOver65 = document.getElementById('spouseIsOver65').checked;
            
            const tipsIncome = parseFloat(document.getElementById('tipsIncome').value) || 0;
            const overtimePay = parseFloat(document.getElementById('overtimePay').value) || 0;
            const carLoanInterest = parseFloat(document.getElementById('carLoanInterest').value) || 0;
            
            const additionalDeductions = parseFloat(document.getElementById('additionalDeductions').value) || 0;
            const priorYearTax = parseFloat(document.getElementById('priorYearTax').value) || 0;

            // 2. Calculate Initial Income Figures
            const netBusinessIncome = Math.max(0, grossIncome - businessExpenses);
            const totalIncome = netBusinessIncome + w2Income;
            const selfEmploymentIncome = netBusinessIncome * 0.9235;

            // 3. Calculate Self-Employment Tax
            const socialSecurityWageBase = 176100;
            let selfEmploymentTax = 0;
            if (selfEmploymentIncome > 0) {
                const socialSecurityTax = Math.min(selfEmploymentIncome, socialSecurityWageBase) * 0.124;
                const medicareTax = selfEmploymentIncome * 0.029;
                selfEmploymentTax = socialSecurityTax + medicareTax;
            }
            const deductibleSETax = selfEmploymentTax * 0.5;

            // 4. Calculate Adjusted Gross Income (AGI)
            const agi = totalIncome - deductibleSETax;

            // 5. Calculate Deductions
            const baseStandardDeductions = { single: 15750, married: 31500, head: 23625 };
            let standardDeduction = baseStandardDeductions[filingStatus];

            // Bonus Deduction for 65+
            let bonusDeduction = 0;
            if (isOver65) {
                const phaseoutStart = (filingStatus === 'married') ? 150000 : 75000;
                const phaseoutEnd = (filingStatus === 'married') ? 250000 : 175000;
                let maxBonus = (filingStatus === 'married') ? (isOver65 && spouseIsOver65 ? 12000 : 6000) : 6000;
                
                if (agi <= phaseoutStart) {
                    bonusDeduction = maxBonus;
                } else if (agi < phaseoutEnd) {
                    const excessIncome = agi - phaseoutStart;
                    const reduction = excessIncome * 0.06;
                    bonusDeduction = Math.max(0, maxBonus - reduction);
                }
            }
            standardDeduction += bonusDeduction;

            const totalOBBBDeductions = tipsIncome + overtimePay + carLoanInterest;
            
            let preQBIDeductibleAmount = standardDeduction + totalOBBBDeductions + additionalDeductions;
            const qbiDeduction = Math.min(netBusinessIncome * 0.20, Math.max(0, (agi - preQBIDeductibleAmount) * 0.20));

            const totalDeductions = preQBIDeductibleAmount + qbiDeduction;
            const taxableIncome = Math.max(0, agi - totalDeductions);

            // 6. Calculate Income Tax
            const taxBrackets = {
                single: [{ min: 0, max: 11925, rate: 0.10 },{ min: 11925, max: 48475, rate: 0.12 },{ min: 48475, max: 103350, rate: 0.22 },{ min: 103350, max: 197300, rate: 0.24 },{ min: 197300, max: 250525, rate: 0.32 },{ min: 250525, max: 626350, rate: 0.35 },{ min: 626350, max: Infinity, rate: 0.37 }],
                married: [{ min: 0, max: 23850, rate: 0.10 },{ min: 23850, max: 96950, rate: 0.12 },{ min: 96950, max: 206700, rate: 0.22 },{ min: 206700, max: 394600, rate: 0.24 },{ min: 394600, max: 501050, rate: 0.32 },{ min: 501050, max: 751600, rate: 0.35 },{ min: 751600, max: Infinity, rate: 0.37 }],
                head: [{ min: 0, max: 17000, rate: 0.10 },{ min: 17000, max: 64850, rate: 0.12 },{ min: 64850, max: 103350, rate: 0.22 },{ min: 103350, max: 197300, rate: 0.24 },{ min: 197300, max: 250500, rate: 0.32 },{ min: 250500, max: 626350, rate: 0.35 },{ min: 626350, max: Infinity, rate: 0.37 }]
            };
            
            let incomeTax = 0;
            let marginalRate = 0;
            const brackets = taxBrackets[filingStatus];
            for (const bracket of brackets) {
                if (taxableIncome > bracket.min) {
                    const taxableInBracket = Math.min(taxableIncome, bracket.max) - bracket.min;
                    incomeTax += taxableInBracket * bracket.rate;
                    marginalRate = bracket.rate * 100;
                } else {
                    break;
                }
            }

            // 7. Apply Credits and Finalize Tax
            let childTaxCredit = 0;
            const ctcPhaseoutStart = (filingStatus === 'married') ? 400000 : 200000;
            if (agi < ctcPhaseoutStart + 40000) { 
                let maxCredit = numChildren * 2200;
                if (agi > ctcPhaseoutStart) {
                    const excessAgi = Math.ceil((agi - ctcPhaseoutStart) / 1000) * 1000;
                    const reduction = (excessAgi / 1000) * 50;
                    childTaxCredit = Math.max(0, maxCredit - reduction);
                } else {
                    childTaxCredit = maxCredit;
                }
            }

            const totalTax = Math.max(0, selfEmploymentTax + incomeTax - childTaxCredit);
            let estimatedTaxDue = Math.max(0, totalTax - w2Withheld);
            
            if (currentMode === 'pro' && priorYearTax > 0) {
                const safeHarborAmount = agi > 150000 ? priorYearTax * 1.1 : priorYearTax;
                if (safeHarborAmount < totalTax) {
                    estimatedTaxDue = Math.max(0, safeHarborAmount - w2Withheld);
                }
            }

            // 8. Final Calculations for Display
            const quarterlyPayment = estimatedTaxDue / 4;
            const monthlySavings = estimatedTaxDue > 0 ? estimatedTaxDue / 12 : 0;
            const effectiveRate = totalIncome > 0 ? (totalTax / totalIncome) * 100 : 0;
            const takeHome = totalIncome - totalTax;

            // 9. Update UI
            document.getElementById('totalIncomeDisplay').textContent = formatCurrency(totalIncome);
            document.getElementById('totalDeductionsDisplay').textContent = formatCurrency(totalDeductions);
            document.getElementById('taxableIncomeDisplay').textContent = formatCurrency(taxableIncome);
            document.getElementById('selfEmploymentTax').textContent = formatCurrency(selfEmploymentTax);
            document.getElementById('incomeTax').textContent = formatCurrency(incomeTax);
            document.getElementById('childTaxCreditDisplay').textContent = `-${formatCurrency(childTaxCredit)}`;
            document.getElementById('totalTax').textContent = formatCurrency(totalTax);
            document.getElementById('taxWithheld').textContent = `-${formatCurrency(w2Withheld)}`;
            document.getElementById('estimatedTaxDue').textContent = formatCurrency(estimatedTaxDue);
            
            document.getElementById('q1Amount').textContent = formatCurrency(quarterlyPayment);
            document.getElementById('q2Amount').textContent = formatCurrency(quarterlyPayment);
            document.getElementById('q3Amount').textContent = formatCurrency(quarterlyPayment);
            document.getElementById('q4Amount').textContent = formatCurrency(quarterlyPayment);
            
            document.getElementById('effectiveRate').textContent = effectiveRate.toFixed(1) + '%';
            document.getElementById('marginalRate').textContent = marginalRate.toFixed(0) + '%';
            document.getElementById('takeHome').textContent = formatCurrency(takeHome);
            document.getElementById('monthlySavings').textContent = formatCurrency(monthlySavings);

            const safeHarborDisplay = priorYearTax > 0 ? formatCurrency(priorYearTax * (agi > 150000 ? 1.1 : 1)) : 'your prior year\'s tax';
            const stepsText = `1. Set up a separate high-yield savings account just for taxes.<br>
                             2. Automatically save <strong>${formatCurrency(monthlySavings)}</strong> every month.<br>
                             3. Add the four quarterly due dates to your calendar with alerts.<br>
                             4. Pay easily online at IRS.gov/payments before each deadline.<br>
                             ${currentMode === 'pro' ? `5. To avoid penalties, ensure your payments meet the Safe Harbor rule (paying at least <strong>${safeHarborDisplay}</strong>).` : ''}`;
            document.getElementById('nextSteps').innerHTML = stepsText;

            document.getElementById('resultsSection').classList.add('show');
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        
        function scrollCarousel(direction) {
            const wrapper = document.querySelector('.carousel-wrapper');
            const cardWidth = wrapper.querySelector('.tool-card').offsetWidth;
            // Scroll by card width + margin (10px on each side = 20px)
            wrapper.scrollBy({ left: (cardWidth + 20) * direction, behavior: 'smooth' });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            setMode('simple');
            updateTipDisplay(); 
            
            document.querySelectorAll('input').forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        calculateTaxes();
                    }
                });
            });

            document.getElementById('eduOverlay').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeEducation();
                }
            });
        });
    </script>
</body>
</html>
